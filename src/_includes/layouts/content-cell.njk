{# layouts/content-cell.njk â€” stabilized thin executor #}

{% set wrapper = cell.wrapper %}

<div class="content-cell" data-cell="{{ wrapper }}">
  {% if cell.includes and (cell.includes | length) %}
    {% for item in cell.includes %}
      {% if item.include %}
        {% set params = item.params or {} %}

        {# Chapter label injection (Header) #}
        {% set id = params.id %}
        {% if sectionTitleId
          and pageItemIndex0 == 0
          and cellIndex0 == 0
          and loop.index0 == 0
          and item.include == "components/header.njk"
        %}
          {% set id = sectionTitleId %}
        {% endif %}

        {# Single include switch (exactly once) #}
        {% if item.include == "components/figure.njk" %}
          {% set figureParams = params %}
          {% include item.include %}

        {% elseif item.include == "components/text-block.njk" %}
          {% set textBlockParams = params %}
          {% include item.include %}

        {% elseif item.include == "components/header.njk" %}
          {% set headerParams = params %}
          {% set headerParamsId = id %}
          {% include item.include %}

        {% elseif item.include == "components/link-block.njk" %}
          {% set linkBlockParams = params %}
          {% include item.include %}

        {% else %}
          <!-- Unknown component include: {{ item.include }} -->
        {% endif %}

      {% endif %}
    {% endfor %}
  {% endif %}
</div>
